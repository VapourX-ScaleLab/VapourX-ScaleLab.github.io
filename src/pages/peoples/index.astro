---
import { Image } from 'astro:assets'
import { Button } from 'astro-pure/user'
import PageLayout from '@/layouts/CommonPage.astro'
import avatar from '@/assets/vapourx-logo-trans.png'
import Icon from '@/components/custom/Icon.astro'

const headings = [
  { depth: 2, slug: 'core-members', text: '核心成员' },
  { depth: 2, slug: 'community-members', text: '社区成员' }
]

import { getAllMembers, getAllTags } from '@/utils/members'

const members = getAllMembers().map(member => ({
  id: member.id,
  name: member.name,
  avatar: member.avatar,
  organization: member.organization,
  role: member.role,
  slogan: member.slogan,
  href: `/peoples/${member.id}`,
  description: member.description,
  github: member.github,
  website: member.website,
  email: member.email,
  linkedin: member.linkedin,
  bilibili: member.bilibili,
  behance: member.behance,
  dribbble: member.dribbble,
  xiaohongshu: member.xiaohongshu,
  x: member.x,
  instagram: member.instagram
}))

const allTags = getAllTags()
---

<PageLayout title='社区成员' {headings} info='/peoples'>
  <Fragment slot='sidebar'>
    {!!allTags.length && (
      <div class='mb-8'>
        <h2 class='mb-4 flex items-center text-lg font-semibold'>
          <Icon name='tag-2' class='me-2' />
          研究兴趣
        </h2>
        <ul class='text-bgColor flex flex-wrap gap-2'>
          {allTags.map((tag) => (
            <li>
              <Button title={tag} href={`/peoples/tags/${encodeURIComponent(tag)}`} style='pill' />
            </li>
          ))}
        </ul>
        <span class='mt-4 block sm:text-end'>
          <a aria-label='查看全部标签' href='/peoples/tags' data-astro-prefetch>
            查看全部 →
          </a>
        </span>
      </div>
    )}
  </Fragment>
  <div class='mx-auto max-w-4xl'>
    <!-- 页面标题 -->
    <div class='mb-8 text-center'>
      <h1 class='mb-4 text-4xl font-bold text-foreground'>社区成员</h1>
      <p class='text-lg text-muted-foreground'>
        认识 VapourX 社区的优秀成员，了解他们的专业领域和贡献
      </p>
    </div>

    <!-- 核心成员 -->
    <section id='core-members' class='mb-12 scroll-mt-20'>
      <h2 class='mb-6 text-2xl font-semibold text-foreground'>核心成员</h2>
      <div class='grid gap-6 md:grid-cols-2'>
        {members.map((member) => (
          <div class='group rounded-lg border p-6 transition-all hover:shadow-lg'>
            <div class='flex items-start gap-4'>
              {/* 头像 */}
              <div class='flex-shrink-0'>
                <div class='relative'>
                  <img 
                    src={member.avatar} 
                    alt={member.name} 
                    class='h-16 w-16 rounded-full border-2 border-border object-cover'
                    width={64}
                    height={64}
                  />
                  <div class='absolute -bottom-1 -right-1 size-4 rounded-full border-2 border-background bg-green-500'></div>
                </div>
              </div>
              
              {/* 成员信息 */}
              <div class='flex-1 min-w-0'>
                <div class='mb-2'>
                  <h3 class='text-lg font-semibold text-foreground md:-mt-[0.5px]'>{member.name}</h3>
                  <p class='text-sm text-muted-foreground'>{member.organization}</p>
                  <p class='text-sm text-primary font-medium'>{Array.isArray(member.role) ? member.role.join(', ') : member.role}</p>
                </div>
                
                <p class='mb-3 text-sm text-muted-foreground italic'>"{member.slogan}"</p>
                

                
                <Button href={member.href} style='primary' class='text-sm'>
                  查看个人主页
                </Button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- 社区成员统计 -->
    <section id='community-members' class='scroll-mt-20'>
      <h2 class='mb-6 text-2xl font-semibold text-foreground'>社区成员</h2>
      <div class='rounded-lg border bg-muted p-6'>
        <div class='grid gap-4 md:grid-cols-3'>
          <div class='text-center'>
            <div class='text-2xl font-bold text-primary'>6</div>
            <div class='text-sm text-muted-foreground'>核心成员</div>
          </div>
          <div class='text-center'>
            <div class='text-2xl font-bold text-primary'>15+</div>
            <div class='text-sm text-muted-foreground'>活跃贡献者</div>
          </div>
          <div class='text-center'>
            <div class='text-2xl font-bold text-primary'>200+</div>
            <div class='text-sm text-muted-foreground'>社区成员</div>
          </div>
        </div>
        <div class='mt-4 text-center'>
          <Button href='/peoples/tags' style='outline' class='text-sm'>
            按标签浏览成员
          </Button>
        </div>
      </div>
    </section>
  </div>
</PageLayout> 
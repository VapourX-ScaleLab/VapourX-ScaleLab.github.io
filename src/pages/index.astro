---
import { Image } from 'astro:assets'

import { Quote } from 'astro-pure/advanced'
import PostPreview from '@/components/custom/PostPreview.astro'
import { getBlogCollection, sortMDByDate } from 'astro-pure/server'
import { getCollection } from 'astro:content'
import { Button, Card, Icon, Label } from 'astro-pure/user'
import PageLayout from '@/layouts/BaseLayout.astro'
import ProjectCard from '@/components/home/ProjectCard.astro'
import Section from '@/components/home/Section.astro'
import SkillLayout from '@/components/home/SkillLayout.astro'

import avatar from '@/assets/avatar.png'
import config from '@/site-config'

const languages = ['Html', 'JavaScript', 'CSS', 'Shell']
const frontend = ['TypeScript', 'Vite', 'Webpack', 'Astro']
const backend = ['Vercel', 'Waline']

const MAX_POSTS = 6
const allPosts = await getBlogCollection()
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
const allActivities = await getCollection('activities')
const recentActivities = allActivities.slice(0, 3)
---

<PageLayout meta={{ title: 'Home' }} highlightColor='#5B8BB3'>
  <style>
    .masonry-container {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .masonry-column {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    @media (min-width: 768px) {
      .masonry-container {
        flex-direction: row;
        gap: 1.5rem;
      }
      .masonry-column {
        flex: 1;
      }
    }
    /* 移动端重新排序 */
    @media (max-width: 767px) {
      .masonry-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      .masonry-column {
        display: contents;
      }
      .masonry-item {
        order: var(--order);
      }
    }
  </style>
  
  <main class='flex w-full flex-col items-center'>
    <section class='animate mb-10 flex flex-col items-center gap-y-7' id='content-header'>
      <div class='avatar-glass h-28 w-auto p-1'>
        <Image
          src={avatar}
          alt='profile'
          class='h-full w-auto rounded-lg'
          loading='eager'
        />
      </div>

      <div class='flex flex-col items-center gap-y-4'>
        <h1 class='animated-gradient-title text-3xl' data-text={config.author}>{config.author}</h1>
        <div class='flex flex-wrap justify-center gap-x-7 gap-y-3'>
          <Label title='China'>
            <Icon name='location' class='size-5' slot='icon' />
          </Label>
          <Label
            title='Source code'
            as='a'
            href='https://github.com/cworld1/astro-theme-pure'
            target='_blank'
          >
            <Icon name='github' class='size-5' slot='icon' />
          </Label>
        </div>
      </div>

      {/* Upload new blog */}
      <a
        href='/newblog'
        target='_blank'
        class='flex flex-row items-center gap-x-4 rounded-full bg-primary/20 text-black px-6 py-3 text-base backdrop-blur-md transition-all duration-300 hover:bg-black hover:text-white hover:shadow-lg hover:scale-105 dark:bg-primary/40 dark:text-white dark:hover:bg-black dark:hover:text-white'
      >
        <p class='font-medium'>Upload New Blog</p>
      </a>
    </section>

    <div id='content' class='animate flex flex-col gap-y-10 md:w-4/5 lg:w-5/6'>
      {/* <Section title='About'>
        <p class='text-muted-foreground'>Developer / Designer</p>
        <p class='text-muted-foreground'>
          Lorem ipsum dolor sit amet, vidit suscipit at mei. Quem denique mea id. Usu ei regione
          indoctum dissentiunt, cu meliore fuisset mei, vel quod voluptua ne. Ex dicat impedit mel,
          at eum oratio possit voluptatum.
        </p>
        <Button title='More about me' class='w-fit self-end' href='/about' style='ahead' />
      </Section> */}
      {
        allPostsByDate.length > 0 && (
          <Section title='Recent Posts'>
            <div class='masonry-container'>
              <div class='masonry-column'>
                {allPostsByDate.filter((_, index) => index % 2 === 0).map((p, colIndex) => (
                  <div class='masonry-item' style={`--order: ${colIndex * 2}`}>
                    <PostPreview post={p} detailed />
                  </div>
                ))}
              </div>
              <div class='masonry-column'>
                {allPostsByDate.filter((_, index) => index % 2 === 1).map((p, colIndex) => (
                  <div class='masonry-item' style={`--order: ${colIndex * 2 + 1}`}>
                    <PostPreview post={p} detailed />
                  </div>
                ))}
              </div>
            </div>
            <Button title='More posts' class='w-fit self-end' href='/blog' style='ahead' />
          </Section>
        )
      }

      {
        /* <Section title='Experience'>
      <Card
        heading='Lorem Ipsum'
        subheading='Sit amet consectetur'
        date='Dec 2022 - Nov 2023'
        imagePath='/src/assets/about-astro.png'
        altText='Lorem, ipsum dolor sit'
        imageClass='h-12 w-auto md:-start-16'
      >
        <ul class='ms-4 list-disc text-muted-foreground'>
          <li>
            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dolore debitis recusandae, ut
            molestiae laboriosam pariatur!

            <li>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae, pariatur!</li>
          </li>
        </ul>
      </Card>
      <Card
        heading='Lorem Ipsum'
        subheading='Sit amet consectetur'
        date='Dec 2022 - Nov 2023'
        imagePath='/src/assets/about-astro.png'
        altText='Lorem, ipsum dolor sit'
        imageClass='h-12 w-auto md:-start-16'
      />
    </Section> */
      }
      {/* <Section title='Education'>
        <Card
          as='a'
          heading='Lorem ipsum'
          subheading='Lorem ipsum dolor sit amet, vidit suscipit at mei.'
          date='August 2021 - July 2025'
          href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
        >
          {
            /* <ul class='ms-4 list-disc text-muted-foreground'>
          <li>
            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dolore debitis recusandae, ut
            molestiae laboriosam pariatur!
          </li>
          <li>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae, pariatur!</li>
        </ul> 
        </Card>
      </Section>} */
    }

      {
        allActivities.length > 0 && (
          <Section title='Recent Activities'>
            <div class='flex flex-col gap-4'>
              {recentActivities.map((activity: any) => (
                <PostPreview post={activity} detailed />
              ))}
            </div>
            <Button title='View all activities' class='w-fit self-end' href='/activities' style='ahead' />
          </Section>
        )
      }

      {/* <Section title='Certifications'>
        <Card
          as='a'
          heading='Lorem ipsum'
          subheading='Lorem ipsum dolor sit amet, vidit suscipit at mei. Quem denique mea id. Usu ei regione indoctum dissentiunt, cu meliore fuisset mei, vel quod voluptua ne. Ex dicat impedit mel, at eum oratio possit voluptatum. Dicat ceteros cu vim. Impetus fuisset ullamcorper pri cu, his posse iisque ad, aliquam honestatis usu id.'
          date='July 2024'
          href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
        />
      </Section>

      <Section title='Skills'>
        <SkillLayout title='Languages' skills={languages} />
        <SkillLayout title='Frontend' skills={frontend} />
        <SkillLayout title='Backend' skills={backend} />
      </Section> */}

      <Section title='About'>
        <p class='text-muted-foreground'>Developer / Designer</p>
        <p class='text-muted-foreground'>
          Lorem ipsum dolor sit amet, vidit suscipit at mei. Quem denique mea id. Usu ei regione
          indoctum dissentiunt, cu meliore fuisset mei, vel quod voluptua ne. Ex dicat impedit mel,
          at eum oratio possit voluptatum.
        </p>
        <Button title='More about us' class='w-fit self-end' href='/about' style='ahead' />
      </Section>
    </div>
    {/* <Quote class='mt-12' /> */}
  </main>
</PageLayout>
